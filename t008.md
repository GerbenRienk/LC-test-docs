# T008: rule management
**Abstract:**  
This documents contains the definitions for tests that concern the management of rules. Rules are used for validation, showing or hiding items, sending mails and scheduling events. This document doesn't apply to correct functioning of the rules: this is tested elsewhere.

## T008-01: download rule-template
**description:**  
This test focuses on downloading the rule-template.

**prerequisite:**  
You must be logged in to a study for which you have the data-manager-role.

**workflow:**  
1. click on **Tasks - Study Setup - Build Study**
1. click on the plus / add icon of task **4 Create Rules**
1. in screen **Import Rule Data [Study Name]** click on link **All actions (without comments)**

**testdata:**  
N.a.

**expected results:**  
The download of the rule-template-file should start.

## T008-02: import a new rule
**description:**  
This test focuses on importing a new rule by uploading an xml-file.

**prerequisite:**  
You must be logged in to a study for which you have the data-manager-role. Furthermore you should have an xml-file with a rule that applies to an item of one of the CRF's in use in your study.

**workflow:**  
1. click on **Tasks - Study Setup - Build Study**
1. click on the plus / add icon of task **4 Create Rules**
1. in screen **Import Rule Data [Study Name]** click on the button labeled **Choose File**
1. browse to the location of the xml-file
1. click on the button labeled **Continue**
1. verify that the message **Congratulations! Your Rule import passed with no errors. Some existing Rules or Rule assignments will be updated or replaced. Review the Rule validation results. You can save it to the database by clicking "Continue".** appears
1. verify that the report of new rules / assignments, updates to rules / assignments and  invalid rules / assignments is correct 
1. click on the button labeled **Continue**
1. click **OK** in the message window

**testdata:**  
N.a.

**expected results:**  
The message **1 Rule(s) and 1 Rule Assignment(s) were uploaded successfully. You can go to Manage Rules to review and test your rules.** (or other numbers, depending on your situation) should appear.

## T008-03: import an update to an existing rule
**description:**  
This test focuses on importing a new rule by uploading an xml-file.

**prerequisite:**  
You must be logged in to a study for which you have the data-manager-role. Furthermore you should have completed successfully **T008-02: import a new rule**, so that you have a rule in your study. Also you must have an xml-file with a modification to the rule: the character of modification, expression or message or assignment or other, is for this test not important.

**workflow:**  
1. click on **Tasks - Study Setup - Build Study**
1. click on the plus / add icon of task **4 Create Rules**
1. in screen **Import Rule Data [Study Name]** click on the button labeled **Choose File**
1. browse to the location of the xml-file with the modification
1. click on the button labeled **Continue**
1. verify that the message **Congratulations! Your Rule import passed with no errors. Some existing Rules or Rule assignments will be updated or replaced. Review the Rule validation results. You can save it to the database by clicking "Continue".** appears
1. verify that the report of new rules / assignments, updates to rules / assignments and  invalid rules / assignments is correct 
1. click on the button labeled **Continue**
1. click **OK** in the message window

**testdata:**  
N.a.

**expected results:**  
The message **1 Rule(s) and 1 Rule Assignment(s) were uploaded successfully. You can go to Manage Rules to review and test your rules.** (or other numbers, depending on your situation) should appear.

## T008-04: import an invalid rule-file
**description:**  
This test focuses on importing an invalid xml-file, which should result in a relevant error-message.

**prerequisite:**  
You must be logged in to a study for which you have the data-manager-role. Furthermore you should have an invalid xml-file. The cause of the file being invalid can be an incorrect OID, an invalid expression, or other.

**workflow:**  
1. click on **Tasks - Study Setup - Build Study**
1. click on the plus / add icon of task **4 Create Rules**
1. in screen **Import Rule Data [Study Name]** click on the button labeled **Choose File**
1. browse to the location of the xml-file with the error
1. click on the button labeled **Continue**
1. verify that the message **Your Rule import had some errors. Review the Rule validation results.** appears

**testdata:**  
N.a.

**expected results:**  
The report of new rules / assignments, updates to rules / assignments and  invalid rules / assignments should give correct feedback on what went wrong. 


## T008-05: find a rule in the list of rules
**description:**  
This test focuses on searching and finding a rule in the list of rules.

**prerequisite:**  
You must be logged in to a study for which you have the data-manager-role. Furthermore you should have completed successfully **T008-02: import a new rule**, so that you have a rule in your study. 

**workflow:**  
1. click on **Tasks - Study Setup - Build Study**
1. click on the magnifier / view icon of task **4 Create Rules**
1. in screen **Manage Rules for [Study Name]** enter the rule-OID of the rule you created in **T008-02: import a new rule** in the grey input-box under **Rule OID**
1. click **Apply Filter**

**testdata:**  
N.a.

**expected results:**  
The rule  you created in **T008-02: import a new rule** should appear in the list of results.

## T008-06: run a rule manually
**description:**  
This test focuses on running a rule manually.

**prerequisite:**  
You must be logged in to a study for which you have the data-manager-role. Furthermore you should have a rule in your study that has for the setting **InitialDataEntry="false"** and you should have one or more CRF's where data have been entered that will trigger the execution of the rule. 

**workflow:**  
1. click on **Tasks - Study Setup - Build Study**
1. click on the magnifier / view icon of task **4 Create Rules**
1. in screen **Manage Rules for [Study Name]** enter the rule-OID of the rule you created for this test in the grey input-box under **Rule OID**
1. click **Apply Filter**
1. click the right arrow /run icon
1. verify that in the screen **Executed Rules Report in Rule Assignment** the message **The rule actions below will be executed for the affected subjects indicated. Click Submit to execute.** appears
1. click the button labeled **Submit**

**testdata:**  
N.a.

**expected results:**  
The message **Actions successfully taken.** should appear.


## T008-XX: remove a rule
## T008-XX: restore a rule

## T008-XX: download a rule
## T008-XX: test a rule



## T008-XX: run all rules for one item
## T008-XX: remove all rules for one item
## T008-XX: download xml file of all rules for one item
## T008-XX: audit log of changes of rules associated with one item 
## T008-XX: download a selection of rules 




